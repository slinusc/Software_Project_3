<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amenity Count</title>
    <!-- Füge Chart.js über CDN ein -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
</head>
<body>
    <!-- Erstelle ein Canvas-Element für das Diagramm -->
    <canvas id="myChart"></canvas>

    <script>
        // Funktion zum Laden der JSON-Daten
        function loadJSON(callback) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open('GET', 'amenity_filtered.json', true); // Hier wird kein Pfad verwendet
            xobj.onreadystatechange = function () {
                if (xobj.readyState == 4 && xobj.status == "200") {
                    // Lade die JSON-Daten und rufe die Callback-Funktion auf
                    callback(JSON.parse(xobj.responseText));
                }
            };
            xobj.send(null);
        }

        // Diagramm erstellen, nachdem die JSON-Daten geladen wurden
        loadJSON(function(data) {
            // Vorverarbeitung der Daten: Zähle die Anzahl der verschiedenen Amenities
            var amenitiesCount = {};
            data.forEach(function(entry) {
                if (entry.node && entry.node.amenity) {
                    var amenity = entry.node.amenity;
                    amenitiesCount[amenity] = (amenitiesCount[amenity] || 0) + 1;
                }
            });

            // Diagramm erstellen
            var ctx = document.getElementById('myChart').getContext('2d');
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(amenitiesCount),
                    datasets: [{
                        label: 'Number of Amenities',
                        data: Object.values(amenitiesCount),
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });
    </script>

 <!-- Erstelle ein Canvas-Element für das Diagramm -->
    <canvas id="populationChart"></canvas>

    <script>
        // Funktion zum Laden der JSON-Daten
        function loadJSON(callback) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open('GET', 'einwohnerzahlen.json', true); // Hier wird kein Pfad verwendet
            xobj.onreadystatechange = function () {
                if (xobj.readyState == 4 && xobj.status == "200") {
                    // Lade die JSON-Daten und rufe die Callback-Funktion auf
                    callback(JSON.parse(xobj.responseText));
                }
            };
            xobj.send(null);
        }

        // Diagramm erstellen, nachdem die JSON-Daten geladen wurden
        loadJSON(function(data) {
            // Extrahiere die Daten für das Diagramm
            var kantonsnamen = data.kantone.map(function(item) {
                return item.Kantonsname;
            });

            var einwohnerzahlen = data.kantone.map(function(item) {
                return item.Einwohnerzahl;
            });

            // Diagramm erstellen
            var ctx = document.getElementById('populationChart').getContext('2d');
            var populationChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: kantonsnamen,
                    datasets: [{
                        label: 'Einwohnerzahl pro Kanton',
                        data: einwohnerzahlen,
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });
    </script>

<!-- Erstelle ein Canvas-Element für das Diagramm -->
    <canvas id="amenityChart"></canvas>

    <script>
        // Funktion zum Laden der JSON-Daten
        function loadJSON(callback) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open('GET', 'ameniteis_incl_canton.json', true); // Pfad zur JSON-Datei mit den Daten
            xobj.onreadystatechange = function () {
                if (xobj.readyState == 4 && xobj.status == "200") {
                    // Lade die JSON-Daten und rufe die Callback-Funktion auf
                    callback(JSON.parse(xobj.responseText));
                }
            };
            xobj.send(null);
        }


        // Diagramm erstellen, nachdem die JSON-Daten geladen wurden
        loadJSON(function (data) {
            // Vorverarbeitung der Daten: Zähle die Anzahl der verschiedenen Amenities pro Kanton
            var amenityCountPerCanton = {};
            data.forEach(function (entry) {
                if (entry.node && entry.node.amenity && entry.node.canton) {
                    var amenity = entry.node.amenity;
                    var canton = entry.node.canton;

                    if (amenity === "drinking_water") {
                        amenityCountPerCanton[canton] = (amenityCountPerCanton[canton] || 0) + 1;
                    }
                }
            });


            // Diagramm erstellen
            var ctx = document.getElementById('amenityChart').getContext('2d');
            var amenityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(amenityCountPerCanton),
                    datasets: [{
                        label: 'Number of Drinking Water Amenities per Canton',
                        data: Object.values(amenityCountPerCanton),
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });

    </script>

<!-- Erstelle ein Canvas-Element für das Diagramm -->
<canvas id="amenityChartCanvas"></canvas>

<!-- Dropdown-Menü für verschiedene Amenities -->
<select id="amenitySelect">
    <option value="drinking_water">Drinking Water</option>
    <option value="shelter">Shelter</option>
    <option value="compressed_air">Compressed Air</option>
</select>


<!-- Einbindung von Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // Funktion zum Laden der JSON-Daten
    function loadJSON(callback) {
        var xobj = new XMLHttpRequest();
        xobj.overrideMimeType("application/json");
        xobj.open('GET', 'ameniteis_incl_canton.json', true); // Pfad zur JSON-Datei mit den Daten
        xobj.onreadystatechange = function () {
            if (xobj.readyState == 4 && xobj.status == "200") {
                // Lade die JSON-Daten und rufe die Callback-Funktion auf
                callback(JSON.parse(xobj.responseText));
            }
        };
        xobj.send(null);
    }


    // Funktion zum Aktualisieren des Diagramms basierend auf der ausgewählten Amenität
    // Funktion zum Aktualisieren des Diagramms basierend auf der ausgewählten Amenität
    function updateChart(selectedAmenity) {
        console.log("Function updateChart executed!"); // Überprüfen, ob diese Zeile in der Konsole erscheint.

        loadJSON(function (data) {
            // Vorverarbeitung der Daten: Zähle die Anzahl der ausgewählten Amenities pro Kanton
            var amenityCountPerCanton = {};
            data.forEach(function (entry) {
                if (entry.node && entry.node.amenity && entry.node.canton) {
                    var amenity = entry.node.amenity;
                    var canton = entry.node.canton;

                    if (amenity === selectedAmenity) {
                        amenityCountPerCanton[canton] = (amenityCountPerCanton[canton] || 0) + 1;
                    }
                }
            });

            // Diagramm aktualisieren
            var ctx = document.getElementById('amenityChartCanvas').getContext('2d');
            if (window.amenityChart) {
                window.amenityChart.destroy(); // Zerstöre das vorhandene Diagramm, wenn es existiert
            }
            window.amenityChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(amenityCountPerCanton),
                    datasets: [{
                        label: 'Number of ' + selectedAmenity.replace('_', ' ').capitalize() + ' Amenities per Canton',
                        data: Object.values(amenityCountPerCanton),
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });
    }

    // Hinzufügen einer capitalize-Funktion zum Formatieren von Amenities für das Diagrammlabel
    String.prototype.capitalize = function () {
        return this.charAt(0).toUpperCase() + this.slice(1);
    };

    // Initiieren des Diagramms mit der Standard-Amenität (Drinking Water)
    updateChart('drinking_water');

    // Dropdown-Änderungsereignis hinzufügen, um das Diagramm bei Auswahl zu aktualisieren
    document.getElementById('amenitySelect').addEventListener('change', function () {
        var selectedAmenity = this.value;
        console.log("Dropdown changed to: " + selectedAmenity); // Test-Log
        updateChart(selectedAmenity);
    });
</script>






</body>
</html>